from core.utils.parser import parse_sql_schema

# یک schema واقعی MySQL با همه حالت‌های ممکن
sql = """
CREATE TABLE `countries` (
  id INT AUTO_INCREMENT,
  name VARCHAR(100),
  PRIMARY KEY (id)
);

CREATE TABLE cities (
  `id` bigint UNSIGNED NOT NULL AUTO_INCREMENT,
  name varchar(255) DEFAULT NULL,
  country_id int NOT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_country` (`country_id`),
  CONSTRAINT `fk_city_country` FOREIGN KEY (`country_id`) 
    REFERENCES `countries` (`id`) ON DELETE CASCADE
);

CREATE TABLE `users` (
  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  username varchar(50) UNIQUE,
  email VARCHAR(255),
  city_id BIGINT UNSIGNED,
  FOREIGN KEY (city_id) REFERENCES cities(id) ON DELETE SET NULL
);
"""

result = parse_sql_schema(sql, dialect="mysql")

import pprint
pprint.pprint(result)